Legacy locking implementation probably not used anywhere anymore